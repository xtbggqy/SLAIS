# LLM Prompt Templates

# 注意：以下提示模板中使用的 {content} 占位符通常会填充完整的文献文本。
# 系统设计上，TokenUsageCallbackHandler (位于 agents/callbacks.py) 会负责计算
# 包括这部分内容在内的总输入Token数量。

METHODOLOGY_ANALYSIS_PROMPT = """
请分析以下文献内容（包括图片分析结果），并以 Markdown 格式返回对研究方法的详细评估。
内容应包含以下部分：
- **方法类型**：例如 "实验研究"、"计算模拟"、"综述"、"理论分析"、"混合方法" 等
- **关键技术**：列出使用的关键技术、算法或实验手段
- **数据来源**：描述数据来源，例如 "公共数据集"、"自行采集"、"模拟生成" 等
- **样本量描述**：如果适用，描述样本量或数据集规模
- **方法优点**：分析该研究方法的优点
- **方法局限性**：分析该研究方法的潜在局限性
- **方法创新点**：研究方法中的创新点

文献内容：
{content}

图片内容分析（如有）：
{image_analysis}

请确保输出是清晰的 Markdown 格式。
"""

INNOVATION_EXTRACTION_PROMPT = """
请仔细阅读以下文献内容（包括图片分析结果），并以 Markdown 格式提取其核心创新点和潜在应用。
内容应包含以下部分：
- **核心创新点**：列出文献的主要创新贡献
- **解决的问题**：描述文献试图解决的核心问题
- **与现有工作相比的新颖性**：与现有工作相比的新颖之处
- **潜在应用**：列出这些创新的潜在应用领域或场景
- **未来研究方向**：文献中暗示或明确提出的未来研究方向

文献内容：
{content}

图片内容分析（如有）：
{image_analysis}

请确保输出是清晰的 Markdown 格式。
"""

QA_GENERATION_PROMPT = """
请根据以下文献内容（包括图片分析结果），生成{num_questions}个高质量的问题，涵盖文献的核心概念和关键发现。
请以 Markdown 格式返回结果，格式如下：

- 问题 1
- 问题 2
- ...

文献内容：
{content}

图片内容分析（如有）：
{image_analysis}
"""

ANSWER_GENERATION_PROMPT = """
请根据以下文献内容（包括图片分析结果），回答以下问题。

问题：{question}

文献内容：
{content}

图片内容分析（如有）：
{image_analysis}

请直接给出答案，不需要重复问题。
"""

BATCH_ANSWER_GENERATION_PROMPT = """
请根据以下文献内容（包括图片分析结果），为下面列出的每一个问题提供一个答案。
请以一个 JSON 列表的格式返回结果，其中每个元素是一个包含 "question" 和 "answer" 键的字典。
确保 JSON 格式正确无误，并且每个问题的文本与此处提供的完全一致。

例如: [{{"question": "问题1的文本", "answer": "答案1的文本"}}, {{"question": "问题2的文本", "answer": "答案2的文本"}}]

文献内容：
{content}

图片内容分析（如有）：
{image_analysis}

问题列表 (请为这些问题生成答案，并确保在输出的JSON中，每个问题的文本与此处提供的完全一致):
{questions_json_list_string}

请严格按照上述JSON格式输出所有问答对。
"""

STORYTELLING_PROMPT = """
请将以下文献内容（包括图片分析结果）用讲故事的方式生动地讲述出来。故事应该有趣、简单易懂，同时不失专业性，能够准确传达文献的核心思想、研究过程和主要发现。请避免使用过于技术性的术语，或者在必要时进行解释。

文献内容：
{content}

图片内容分析（如有）：
{image_analysis}

请以流畅的叙述体 Markdown 格式返回故事。
"""

MINDMAP_PROMPT = """
请根据以下文献内容（包括图片分析结果），生成一个概括全文逻辑结构的 Mermaid 格式的脑图（思维导图）。
脑图应清晰地展示文献的主要章节、关键概念、研究流程或论证结构。
请确保输出是有效的 Mermaid 语法代码块，例如：

```mermaid
graph TD
    A[文献标题] --> B(引言)
    B --> C[研究问题]
    C --> D[方法]
    D --> E[结果]
    E --> F[讨论]
    F --> G[结论]
```

文献内容：
{content}

图片内容分析（如有）：
{image_analysis}

请只返回 Mermaid 代码块，不要包含额外的解释文本。
```
"""

# 图片内容分析基础提示词
IMAGE_ANALYSIS_BASE_PROMPT = """
请对学术论文中的图片进行简洁、准确的内容分析。对于每张图片，请提供以下信息：

1. **图片类型**: 明确指出是图表（如柱状图、折线图、散点图）、照片、流程图、示意图、表格还是其他类型。

2. **主要内容描述**: 简洁描述图片展示的关键信息、元素、趋势或模式。重点包括：
   - 图表：坐标轴含义、数据趋势、关键数据点
   - 照片：主要对象和重要细节
   - 流程图：主要步骤和关系
   
3. **主要发现或结论**: 简要提炼图片所支持的主要研究发现或结论。

4. **与文献内容的关联**: 简要说明图片在文献中的作用。

注意事项：
- 保持描述简洁明了，避免重复和冗余
- 每个部分控制在2-3句话以内
- 使用准确的科学术语
- 避免主观推测和过度解读

请用清晰、简洁的中文学术语言输出结构化描述。
"""
